#include <stdio.h>
#include <stdlib.h>

/*
 * Задание:
 * Дана последовательность коэффициентов многочлена по возрастанию степеней.
 * Требуется:
 * - Вычислить значение многочлена P(x) в заданной точке x
 * - Вычислить значение производной P'(x) в той же точке
 *
 * Используется алгоритм Горнера.
 */

int main(void) {
    int n;

    // Ввод степени многочлена
    printf("Введите степень многочлена (n): ");
    scanf("%d", &n);

    // Выделение памяти под (n + 1) коэффициентов
    double *a = (double *)malloc((n + 1) * sizeof(double));
    if (a == NULL) {
        printf("Ошибка: недостаточно памяти.\n");
        return 1;
    }

    // Ввод коэффициентов a[0] до a[n]
    printf("Введите %d коэффициентов (от a[0] до a[%d]):\n", n + 1, n);
    for (int i = 0; i <= n; ++i) {
        printf("a[%d] = ", i);
        scanf("%lf", &a[i]);
    }

    // Ввод точки x, в которой нужно вычислить значение
    double x;
    printf("Введите значение x: ");
    scanf("%lf", &x);

    // b — значение многочлена P(x)
    // c — значение производной P'(x)
    double b = a[n];    // Начинаем с последнего коэффициента
    double c = 0.0;     // Начальное значение для производной

    // Алгоритм Горнера: вычисление P(x) и P'(x) одновременно
    for (int k = n - 1; k >= 0; --k) {
        c = c * x + b;      // новое значение производной
        b = b * x + a[k];   // новое значение самого многочлена
    }

    // Вывод результата
    printf("\n--- Результаты ---\n");
    printf("P(x)  = %.6lf\n", b);  // значение многочлена
    printf("P'(x) = %.6lf\n", c);  // значение производной

    // Освобождение памяти
    free(a);
    return 0;
}
